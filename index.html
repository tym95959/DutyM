<!DOCTYPE html>
<html>
<head>
  <title>PAW Alerts</title>
  <link rel="manifest" href="manifest.json">
</head>
<body>
<h2>PAW Announcements</h2>
<ul id="messages"></ul>

<script src="dcfire.js"></script>

<script>
navigator.serviceWorker.register("firebase-messaging-sw.js");

messaging.requestPermission()
.then(() => messaging.getToken())
.then(token => {
  db.collection("tokens").doc(token).set({ token });
});

db.collection("announcements")
.orderBy("time","desc")
.onSnapshot(snapshot => {
  messages.innerHTML = "";
  snapshot.forEach(doc => {
    const li = document.createElement("li");
    li.textContent = doc.data().text;
    messages.appendChild(li);
  });
});
</script>
</body>
</html>
