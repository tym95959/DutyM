<!DOCTYPE html>
<html>
<head>
  <title>PAW Alerts</title>
  <link rel="manifest" href="manifest.json">
</head>
<body>
<h2>PAW Announcements</h2>
<ul id="messages"></ul>

<script src="dcfire.js"></script>

<script>
navigator.serviceWorker.register("firebase-messaging-sw.js");

messaging.requestPermission()
.then(() => messaging.getToken({
  vapidKey: "BCMEhQHZvwuii0Pul11PRfM68N_C4iox9c6jUwWoj21lvKZ2hhAfRe-5KwG_A1xMsQ04aelb8XM7x-mXNYzak1o"
}))
.then(token => {
  db.collection("tokens").doc(token).set({ token });
  console.log("FCM Token:", token);
})
.catch(err => {
  console.error("Permission denied", err);
});


db.collection("announcements")
.orderBy("time","desc")
.onSnapshot(snapshot => {
  messages.innerHTML = "";
  snapshot.forEach(doc => {
    const li = document.createElement("li");
    li.textContent = doc.data().text;
    messages.appendChild(li);
  });
});
</script>
</body>
</html>
